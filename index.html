<!DOCTYPE html>
<html manifest="manifest.appcache">
  <head>
  <meta charset="utf-8"> 
    <meta http-equiv="pragma" content="no-cache">
    <title>Payment Demo</title> 
  </head>
  <body>
    <script>
      // Mock public payment provider JWT
      const mockJWT = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiIxMjM0NTY3ODkiLCJhdWQiOiJNb2NrIFBheW1lbnQgUHJvdmlkZXIiLCJ0eXAiOiJtb2NrXC9wYXltZW50c1wvaW5hcHBcL3YxIiwiZXhwIjoxMzQzMjI4NzA2LCJpYXQiOjEzNDMyMjUxMDYsInJlcXVlc3QiOnsibmFtZSI6IlBpZWNlIG9mIENha2UiLCJkZXNjcmlwdGlvbiI6IlZpcnR1YWwgY2hvY29sYXRlIGNha2UgdG8gZmlsbCB5b3VyIHZpcnR1YWwgdHVtbXkiLCJwcmljZSI6IjEwLjUwIiwiY3VycmVuY3lDb2RlIjoiVVNEIiwic2VsbGVyRGF0YSI6InVzZXJfaWQ6MTIyNDI0NSxvZmZlcl9jb2RlOjMwOTg1NzY5ODcsYWZmaWxpYXRlOmFrc2RmYm92dTlqIn19.iQiM5PXy6Vnz9oTNyLO81gunC4A7AVbQDAjFeykv6fs";

      // BlueVia JWT
      const blueviaJWT = "eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCJ9.IntcImlzc1wiOiBcIjM0WFYzN0JEUkJCRjRLWkNTOVFVXCIsIFwiaWF0XCI6IDEzNDIxODMwODUsIFwidHlwXCI6IFwidHUuY29tL3BheW1lbnRzL2luYXBwL3YxXCIsIFwicmVxdWVzdFwiOiB7XCJuYW1lXCI6IFwiUGllY2Ugb2YgQ2FrZVwiLCBcInByaWNlXCI6IFwiMTAuNTBcIiwgXCJwcmljZVRpZXJcIjogMSwgXCJwcm9kdWN0ZGF0YVwiOiBcInRyYW5zYWN0aW9uX2lkPTEwNFwiLCBcImN1cnJlbmN5Q29kZVwiOiBcIlVTRFwiLCBcImRlc2NyaXB0aW9uXCI6IFwiVmlydHVhbCBjaG9jb2xhdGUgY2FrZSB0byBmaWxsIHlvdXIgdmlydHVhbCB0dW1teVwifSwgXCJleHBcIjogMTM0MjE4NjY4NX0i.NKGlx9M6El7OOHM9DfrTYB3OaC0pa6JarymWK2-_dQQ";
      
      // Mozilla Marketplace JWT
      const marketplaceJWT = "eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCJ9.IntcImF1ZFwiOiBcIm1hcmtldHBsYWNlLm1vemlsbGEub3JnXCIsIFwiaXNzXCI6IFwiQVBQLTEyM1wiLCBcInJlcXVlc3RcIjoge1wiY3VycmVuY3lcIjogXCJVU0RcIiwgXCJwcmljZVwiOiBcIjAuOTlcIiwgXCJuYW1lXCI6IFwiVmlydHVhbCAzRCBHbGFzc2VzXCIsIFwicHJvZHVjdGRhdGFcIjogXCJBQkMxMjNfREVGNDU2X0dISV83ODkuWFlaXCIsIFwiZGVzY3JpcHRpb25cIjogXCJWaXJ0dWFsIDNEIEdsYXNzZXNcIn0sIFwiZXhwXCI6IFwiMjAxMi0wMy0yMVQxMTowOTo1Ni43NTMxNDFcIiwgXCJpYXRcIjogXCIyMDEyLTAzLTIxVDEwOjA5OjU2LjgxMDQyMFwiLCBcInR5cFwiOiBcIm1vemlsbGEvcGF5bWVudHMvcGF5L3YxXCJ9Ig.vl4E31_5H3t5H_mM8XA69DqypCqdACVKFy3kXz9EmTI";

      // Invalid typ JWT
      const invalidJWT = "eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCJ9.IntcImF1ZFwiOiBcImNvbm5lY3QucWEtb3BlbnRlbC0wNC5oaS5pbmV0XCIsIFwiaXNzXCI6IFwiMzRYVjM3QkRSQkJGNEtaQ1M5UVVcIiwgXCJyZXF1ZXN0XCI6IHtcIm5hbWVcIjogXCJQaWNlIG9mIENha2VcIiwgXCJwcmljZVwiOiAxMC41LCBcInByaWNlVGllclwiOiAxLCBcInByb2R1Y3RkYXRhXCI6IFwidHJhbnNhY3Rpb25faWQ9MTJcIiwgXCJjdXJyZW5jeUNvZGVcIjogXCJVU0RcIiwgXCJkZXNjcmlwdGlvblwiOiBcIlZpcnR1YWwgY2hvY29sYXRlIGNha2UgdG8gZmlsbCB5b3VyIHZpcnR1YWwgdHVtbXlcIn0sIFwiZXhwXCI6IDEzNDIwMDMwNzA1MTMsIFwiaWF0XCI6IDEzNDIwMDMwNzQxMTMsIFwidHlwXCI6IFwicGF5bWVudHMvaW5hcHAvdjFcIn0i.I5rFwoBtgyTltMJ_11rHOgcto-HdFbYlIOgVOVSlJe0";
   
      function pay(JWTs) {
        var request = navigator.pay(JWTs);
        request.onsuccess = function onsuccess() {
          console.log("onsuccess received");
          document.getElementById("result").innerHTML = "Payment success";
        };
        request.onerror = function onerror() {
          console.log("onerror received");
          document.getElementById("result").innerHTML = "Payment error " + request.error.name;
        };
      }
    </script>
    <div>
      PMPP = Public Mock Payment Provider
    </div>
    <div>
      <span id="result"></span>
    </div>
    <ul>
      <li>
        <button type=button style="width:100px;height:100px" onclick="pay(mockJWT)">
          Pay PMPP
        </button>
      </li>
      <li>
        <button type=button style="width:100px;height:100px" onclick="pay(mockJWT)">
          Pay with PMPP or BlueVia
        </button>
      </li>    
      <li>
        <button type=button style="width:100px;height:100px" onclick="pay(blueviaJWT)">
          Pay with BlueVia
        </button>
      </li>
      <li>
        <button type=button style="width:100px;height:100px" onclick="pay([blueviaJWT, marketplaceJWT])">
          Pay with BlueVia or Mozilla Marketplace
        </button>
      </li>
      <li>
        <button type=button style="width:100px;height:100px" onclick="pay([invalidJWT])">
          Pay with invalid JWT
        </button>
      </li>
      <li>
        <button type=button style="width:100px;height:100px" onclick="pay([])">
          Pay with no JWT
        </button>
      </li>
      <li>
        <button type=button style="width:100px;height:100px" onclick="pay([blueviaJWT, blueviaJWT])">
          Pay with repeated BlueVia JWT
        </button>
      </li>
      <li>
        <button type=button style="width:100px;height:100px" onclick="pay([blueviaJWT, blueviaJWT, marketplaceJWT])">
          Pay with repeated BlueVia JWT or Mozilla Marketplace
        </button>
      </li>
      <li>
        <button type=button style="width:100px;height:100px" onclick="pay([invalidJWT, invalidJWT])">
          Pay with repeated invalid JWT
        </button>
      </li>
    </ul>
  </body>
</html>
